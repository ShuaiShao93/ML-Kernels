import numpy as np

a = np.array(
    [[[-0.3725506 , -0.28381005, -0.6757634 ,  0.39714357, -0.34843445,  0.10886797,  1.8641977 , -0.29166105],
        [-0.5966838 , -2.3873625 ,  1.9051796 ,  0.19815196, -0.22335552,  0.4202099 ,  0.03917789, -0.34200248],
        [ 1.5007868 , -0.773806  ,  0.86250186, -0.20337829, -0.4317221 , -0.7182585 , -1.4819537 ,  1.4621428 ],
        [-1.2293124 ,  1.0733782 ,  1.3566197 , -0.84581065,  1.8557936 , -0.38894507, -0.6487552 , -0.8723988 ],
        [ 0.1120503 , -1.2460387 ,  0.54012996,  0.6054315 ,  0.20958328,  0.25879657, -0.65695935,  0.8996165 ],
        [ 0.92016983,  1.0609947 , -0.6160404 , -0.96238124,  1.1215098 , -1.1113249 , -0.19420591,  0.6802828 ]],

       [[ 1.4071065 , -0.11908474,  2.4445255 ,  0.1752031 , -1.0811107 ,  1.1767058 , -1.8021564 , -1.133009  ],
        [ 0.5624114 , -1.276573  ,  0.24700384,  1.2854303 , -0.66219306,  0.13336341, -0.9738342 ,  0.34439242],
        [-0.8619331 ,  0.11292981, -0.94514185,  1.1379412 , -2.0326254 , -0.0903286 , -0.12946245,  0.16627854],
        [ 0.08213651,  0.6983816 , -1.0304182 ,  1.3358743 , -0.64447874, -1.3363965 , -0.11725084,  0.7132715 ],
        [ 0.34774983, -0.6027692 , -0.38648593,  0.29292688, -0.38954186, -0.541923  ,  0.58408916, -1.9250168 ],
        [-1.9248472 , -1.4377298 ,  0.8386536 , -0.8127423 , -0.8516411 ,  2.7629218 ,  0.12047017, -0.18997441]],

       [[-1.575225  ,  0.88077736, -0.5404277 ,  1.0683624 , -0.83442223, -0.7078711 , -0.772049  ,  0.64322644],
        [-0.9270517 , -0.98409337, -2.2209942 ,  0.447558  , -0.4788594 ,  0.69394153, -0.95345503, -1.2909646 ],
        [-0.27108088, -0.32526872,  1.5147754 , -1.0340438 ,  0.5481503 ,  0.5964004 ,  1.5721949 , -0.7952686 ],
        [-0.16752139,  0.81554604, -2.3011656 ,  0.23699918,  0.24439839, -0.4435273 , -0.19903654,  0.05224606],
        [ 0.5042187 ,  1.3943939 ,  0.19088347, -1.1008248 , -0.33233848,  1.5314947 , -0.76357454,  0.94795054],
        [ 0.3449667 , -0.669001  , -0.5794092 , -0.33720374, -0.6298589 ,  1.7404269 ,  0.2896732 , -0.18859151]],

       [[ 0.62601453, -1.9049968 , -0.37263092, -0.70232326,  0.04581042, -1.1944014 ,  1.1830734 , -1.1422187 ],
        [ 0.25533372,  1.2952129 , -1.155552  ,  1.4990089 , -1.3744184 ,  0.95252717,  2.2887044 ,  0.63618517],
        [-1.8524213 ,  0.45133448,  0.5371158 , -0.14097089,  0.83267605, -0.24025552, -0.26416498,  0.8943536 ],
        [-0.3194733 ,  2.0850368 , -0.76487917, -0.4275797 , -1.5189128 , -2.1232874 , -0.5762331 , -1.0521888 ],
        [-1.5705651 , -0.12531263, -0.43964127, -0.88736165, -0.06116815,  1.1743985 ,  0.04700081,  1.726591  ],
        [-0.9130958 , -1.3363651 ,  0.72177386,  0.7512668 , -0.6672994 , -0.25595   ,  2.4298046 ,  0.9112854 ]],

       [[ 0.35638934, -0.03945763, -0.6450628 , -0.64713377, -1.1074471 , -0.6750069 , -2.148804  , -1.4955119 ],
        [ 0.8769035 ,  0.41327888,  0.03917689, -0.06301763,  1.5626029 , -1.6929896 ,  0.608212  ,  0.9375726 ],
        [-0.69700813,  1.349376  ,  0.67633027,  0.2553532 ,  0.2611108 ,  1.4726031 ,  0.84151745,  0.6283697 ],
        [-0.6707056 , -0.97934365, -0.3421286 , -0.90332556,  0.15726317, -0.18828687,  1.3128959 , -0.62132317],
        [ 0.05203031, -0.73422724,  0.08691907, -0.04634409,  1.2769397 , -0.2739152 ,  0.42064708,  0.6188359 ],
        [-0.7659196 , -0.3557465 , -0.14846021, -0.7391733 ,  0.17945969,  1.9867461 ,  0.16743648,  0.24027345]],

       [[-0.31040174, -0.29524302, -0.7811392 , -0.46420455,  0.85730445,  0.69174874, -0.8120705 , -0.47508487],
        [-1.5071306 , -0.8624713 ,  1.793737  , -0.23024052,  1.0126765 , -2.7760715 ,  1.6250261 ,  0.24186623],
        [ 0.9859723 ,  1.084577  ,  0.18142788,  0.1560239 , -0.09244175,  0.23618804,  0.05547163, -0.639974  ],
        [-0.6467232 , -1.1146729 ,  0.51220113,  0.8091611 ,  0.16727695, -0.5906019 ,  0.44336802,  1.552504  ],
        [-0.82486975, -0.26777372,  0.7088719 ,  0.35398307,  1.1325241 ,  0.8639637 , -0.33568004, -0.17925113],
        [-0.4952189 , -0.09431253,  0.7587404 , -0.8857132 ,  1.4010249 ,  1.5640508 , -0.03157043,  0.33769482]]]
)

b = np.array(
    [[ 0.5539172 ,  0.21727926,  0.3616895 ,  0.3132674 , -0.02944827,  0.16045976, -0.38454497, -0.47237462],
         [-0.2005865 ,  0.27352846, -0.3439088 ,  0.4376474 ,  0.39671987,  0.11685628, -0.6087439 , -0.3095485 ],
         [ 0.0074392 , -0.16951853, -0.55745685,  0.578283  ,  0.40219206, -0.10461277,  0.12451488, -0.1964652 ],
         [ 0.0895322 , -0.3230197 ,  0.2140665 , -0.60340714, -0.5867598 ,  0.56568474,  0.16473204, -0.3352194 ],
         [ 0.18559295,  0.44951588, -0.30062592, -0.2785297 , -0.04313833, -0.2545635 , -0.35507464, -0.09051007],
         [ 0.53060704, -0.10115093,  0.26315796,  0.08113652, -0.24401945,  0.4283597 , -0.05742717, -0.6070669 ],
         [-0.50114673, -0.26315477,  0.30218625,  0.4571193 , -0.10402453,  0.52195626,  0.08375198, -0.11518046],
         [ 0.38679105,  0.5240955 , -0.31034842, -0.03778285, -0.08116895,  0.42155463,  0.27837145,  0.12917161]]
)

scale = 0.047244094488188976

a = np.around(a / scale)
a.clip(-127, 127)
a = a.astype(np.int32)

b = np.around(b / scale)
b.clip(-127, 127)
b = b.astype(np.int32)

c = np.dot(a, b)
c = c.astype(np.float16)
c = np.around(c * scale)
c.clip(-127, 127)
c[c<0] = 0
c = c.astype(np.int8)

c = c.astype(np.float16)
c = c * scale

print(c.shape)
print(c[:, :, 0])

"""
[[0.     0.1417 1.843  0.     1.181  0.189 ]
 [1.748  1.275  0.     0.     0.     0.189 ]
 [0.     0.     0.     0.     1.417  0.8506]
 [0.     0.     0.     0.     0.2834 0.    ]
 [0.1417 0.     0.     0.     0.2834 0.6143]
 [0.567  0.     0.189  0.     0.378  0.8975]]
"""